<view class="form-container {{theme === 'dark' ? 'dark' : ''}}">
  <!-- å¤´éƒ¨ -->
  <view class="form-header">
    <view class="header-btn" bindtap="onBack">
      <text class="back-icon">âœ•</text>
    </view>
    
    <view class="header-title">
      <text class="title-text">{{mode === 'edit' ? 'ç¼–è¾‘è®°å½•' : 'æ–°å»ºè®°å½•'}}</text>
      <text class="subtitle-text">{{mode === 'edit' ? 'æ›´æ–°æ¼”å‡º' : 'æ·»åŠ æ¼”å‡º'}}</text>
    </view>
    
    <view class="header-btn save-btn" bindtap="onSave">
      <text class="save-text">ä¿å­˜</text>
    </view>
  </view>

  <!-- è¡¨å•å†…å®¹ -->
  <scroll-view class="form-content" scroll-y="true">
    <!-- ç¥¨åŠ¡é“¾æ¥è§£æ -->
    <view class="ticket-parser-section">
      <text class="section-title">ğŸ”— ç¥¨åŠ¡é“¾æ¥è§£æ</text>
      <view class="parser-input-row">
        <input 
          class="parser-input"
          type="text"
          placeholder="ç²˜è´´ç¥¨åŠ¡å¹³å°é“¾æ¥ï¼ˆå¤§éº¦ã€çŒ«çœ¼ç­‰ï¼‰"
          value="{{ticketUrl}}"
          bindinput="onTicketUrlInput"
        />
        <view class="parse-btn" bindtap="onParseTicket">
          <text>è§£æ</text>
        </view>
      </view>
    </view>

    <!-- æµ·æŠ¥ä¸Šä¼  -->
    <view class="poster-upload">
      <label class="upload-label">
        <image 
          wx:if="{{formData.posterImage}}"
          class="poster-image" 
          src="{{formData.posterImage}}" 
          mode="aspectFill"
          bindtap="onPreviewImage"
          data-url="{{formData.posterImage}}"
        />
        <view wx:else class="poster-placeholder" bindtap="onUploadPoster">
          <text class="placeholder-icon">ğŸ“·</text>
          <text class="placeholder-text">ä¸Šä¼ æµ·æŠ¥</text>
        </view>
      </label>
      
      <view wx:if="{{formData.posterImage}}" class="image-actions">
        <view class="image-btn delete-btn" bindtap="onDeleteImage" data-field="posterImage">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>

    <!-- åŸºæœ¬ä¿¡æ¯ -->
    <view class="form-section">
      <view class="input-group">
        <input 
          class="form-input title-input {{theme === 'dark' ? 'dark' : ''}}"
          type="text"
          placeholder="è¯·è¾“å…¥å‰§ç›®åç§°"
          value="{{formData.title}}"
          bindinput="onInputChange"
          bindfocus="onInputFocus"
          bindblur="onInputBlur"
          data-field="title"
        />
      </view>

      <view class="form-row">
          <view class="input-group half">
            <text class="input-label">ğŸ“… æ—¥æœŸ</text>
            <picker mode="date" start="2025-01-01" end="2030-12-31" bindchange="onDateChange">
              <view class="selector-input">
                <text class="selector-text {{formData.date ? '' : 'placeholder'}}">
                  {{formData.date || 'é€‰æ‹©æ—¥æœŸ'}}
                </text>
                <text class="selector-arrow">â–¼</text>
              </view>
            </picker>
          </view>
          
          <view class="input-group half">
            <text class="input-label">ğŸ• æ—¶é—´</text>
            <picker mode="time" bindchange="onTimeChange">
              <view class="selector-input">
                <text class="selector-text {{formData.time ? '' : 'placeholder'}}">
                  {{formData.time || 'é€‰æ‹©æ—¶é—´'}}
                </text>
                <text class="selector-arrow">â–¼</text>
              </view>
            </picker>
          </view>
      </view>

      <view class="input-group">
        <text class="input-label">ğŸ“ å‰§é™¢</text>
        <view class="selector-input" bindtap="onToggleLocationPicker">
            <text class="selector-text {{formData.location ? '' : 'placeholder'}}">
              {{formData.location || 'é€‰æ‹©å‰§é™¢'}}
            </text>
            <text class="selector-arrow">â–¼</text>
          </view>
      </view>

      <!-- å‰§é™¢é€‰æ‹©å™¨ -->
      <view wx:if="{{showLocationPicker}}" class="location-picker-modal">
        <view class="picker-overlay" bindtap="onToggleLocationPicker"></view>
        <view class="picker-content">
          <view class="picker-header">
            <text class="picker-title">é€‰æ‹©å‰§é™¢</text>
            <view class="picker-close" bindtap="onToggleLocationPicker">
              <text>âœ•</text>
            </view>
          </view>
          
          <!-- åŸå¸‚-å‰§é™¢ä¸¤çº§é€‰æ‹© -->
          <view class="two-level-picker">
            <!-- å·¦ä¾§åŸå¸‚åˆ—è¡¨ -->
            <scroll-view class="city-list" scroll-y="true">
              <block wx:for="{{cities}}" wx:key="*this">
                <view 
                  class="city-item {{selectedCity === item ? 'active' : ''}}"
                  bindtap="onCitySelect"
                  data-city="{{item}}"
                >
                  <text>{{item}}</text>
                </view>
              </block>
            </scroll-view>
            
            <!-- å³ä¾§å‰§é™¢åˆ—è¡¨ -->
            <scroll-view class="venue-list" scroll-y="true">
              <block wx:for="{{venues[selectedCity]}}" wx:key="*this">
                <view 
                  class="venue-item"
                  bindtap="onVenueSelect"
                  data-venue="{{item}}"
                >
                  <text>{{item}}</text>
                </view>
              </block>
            </scroll-view>
          </view>
        </view>
      </view>

      <view class="input-group">
        <text class="input-label">ğŸ’° Price</text>
        <input 
          class="form-input {{theme === 'dark' ? 'dark' : ''}}"
          type="digit"
          placeholder="0.00"
          value="{{formData.price}}"
          bindinput="onNumberInput"
          bindfocus="onInputFocus"
          bindblur="onInputBlur"
          data-field="price"
        />
      </view>
    </view>

    <!-- æ¼”èŒäººå‘˜ -->
    <view class="cast-section">
      <text class="section-title">ğŸ‘¥ Cast & Crew</text>
      
      <view class="cast-list">
        <view wx:for="{{formData.cast}}" wx:key="index" class="cast-item">
          <text class="cast-actor">{{item.actor}}</text>
          <text wx:if="{{item.role}}" class="cast-role">{{item.role}}</text>
          <view class="cast-delete" bindtap="onDeleteCast" data-index="{{index}}">
            <text>âœ•</text>
          </view>
        </view>
      </view>
      
      <view wx:if="{{formData.cast.length === 0}}" class="cast-empty">
        <text>No cast added yet</text>
      </view>
      
      <view class="cast-input-row">
        <input 
          class="cast-input actor-input"
          type="text"
          placeholder="Actor Name"
          value="{{castInput.actor}}"
          bindinput="onCastInputChange"
          bindfocus="onInputFocus"
          bindblur="onInputBlur"
          data-field="actor"
        />
        <input 
          class="cast-input role-input"
          type="text"
          placeholder="Role"
          value="{{castInput.role}}"
          bindinput="onCastInputChange"
          bindfocus="onInputFocus"
          bindblur="onInputBlur"
          data-field="role"
        />
        <view class="cast-add-btn" bindtap="onAddCast">
          <text>+</text>
        </view>
      </view>
    </view>

    <!-- åº§ä½å›¾ä¸Šä¼  -->
    <view class="seat-upload">
      <text class="section-title">ğŸ“¸ åº§ä½å›¾/ç¥¨æ ¹</text>
      
      <label class="seat-upload-label">
        <image 
          wx:if="{{formData.seatImage}}"
          class="seat-image" 
          src="{{formData.seatImage}}" 
          mode="aspectFill"
          bindtap="onPreviewImage"
          data-url="{{formData.seatImage}}"
        />
        <view wx:else class="seat-placeholder" bindtap="onUploadSeatImage">
          <text class="placeholder-icon">ğŸ“·</text>
          <text class="placeholder-text">æ·»åŠ ç…§ç‰‡</text>
        </view>
      </label>
      
      <view wx:if="{{formData.seatImage}}" class="image-actions">
        <view class="image-btn delete-btn" bindtap="onDeleteImage" data-field="seatImage">
          <text>åˆ é™¤</text>
        </view>
      </view>
    </view>

    <!-- å¤‡æ³¨ -->
    <view class="notes-section">
      <text class="section-title">ğŸ“ è§‚æ¼”ç¬”è®°</text>
      <textarea 
        class="notes-input {{theme === 'dark' ? 'dark' : ''}}"
        placeholder="è®°å½•è§‚æ¼”æ„Ÿå—ã€æ¼”å‘˜è¡¨ç°ã€å‰§åœºç¯å¢ƒç­‰..."
        value="{{formData.notes}}"
        bindinput="onInputChange"
        data-field="notes"
      />
    </view>
    
    <view class="form-spacer"></view>
  </scroll-view>
</view>