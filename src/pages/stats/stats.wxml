<view class="stats-container {{theme === 'dark' ? 'dark' : ''}}">
  <!-- Ê†áÈ¢òÂå∫Âüü -->
  <view class="header-section">
    <text class="page-title">Analytics</text>
    <text class="page-subtitle">DATA VISUALIZATION</text>
  </view>

  <!-- Êó∂Èó¥ËåÉÂõ¥ÈÄâÊã© -->
  <view class="time-range-selector">
    <view class="range-tabs">
      <view 
        class="range-tab {{timeRange === 'day' ? 'active' : ''}}"
        bindtap="onTimeRangeChange"
        data-range="day"
      >
        DAY
      </view>
      <view 
        class="range-tab {{timeRange === 'month' ? 'active' : ''}}"
        bindtap="onTimeRangeChange"
        data-range="month"
      >
        MONTH
      </view>
      <view 
        class="range-tab {{timeRange === 'year' ? 'active' : ''}}"
        bindtap="onTimeRangeChange"
        data-range="year"
      >
        YEAR
      </view>
    </view>
  </view>

  <!-- Êó•ÊúüÈÄâÊã©Âô® -->
  <view class="date-selector">
    <view class="date-btn" bindtap="onPrevDate">
      <text class="date-arrow">‚Äπ</text>
    </view>
    
    <text class="date-label">{{dateLabel}}</text>
    
    <view class="date-btn" bindtap="onNextDate">
      <text class="date-arrow">‚Ä∫</text>
    </view>
  </view>

  <!-- Ê†∏ÂøÉÁªüËÆ° -->
  <view class="stats-grid">
    <!-- ÊºîÂá∫Êï∞Èáè -->
    <view class="stat-card glass">
      <view class="stat-header">
        <view class="stat-badge">
          <text class="badge-text">COUNT</text>
        </view>
      </view>
      
      <view class="stat-content">
        <text class="stat-number">{{stats.totalShows}}</text>
        <text class="stat-unit">SHOWS</text>
      </view>
      
      <view class="stat-icon">üèÜ</view>
    </view>

    <!-- ÊÄªÊ∂àË¥π -->
    <view class="stat-card expense-card">
      <view class="stat-header">
        <view class="stat-badge expense-badge">
          <text class="badge-text">ÊÄªÊ∂àË¥π</text>
        </view>
      </view>
      
      <view class="stat-content">
        <text class="stat-number expense-number">¬•{{stats.totalSpent}}</text>
      </view>
      
      <view class="expense-bg"></view>
    </view>
  </view>

  <!-- Âú∫È¶ÜÂàÜÂ∏ÉÂõæË°® -->
  <view wx:if="{{pieData.length > 0}}" class="chart-card glass">
    <view class="chart-header">
      <text class="chart-title">üìç Venues</text>
    </view>
    
    <!-- È•ºÂõæÂå∫Âüü -->
    <view class="pie-chart-container">
      <canvas 
        class="pie-chart" 
        canvas-id="pieChart"
        disable-scroll="true"
      ></canvas>
    </view>
    
    <!-- Âõæ‰æã -->
    <view class="chart-legend">
      <view wx:for="{{pieData}}" wx:key="name" class="legend-item">
        <view class="legend-color" style="background-color: {{item.color}};"></view>
        <text class="legend-text">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- ÂéÜÂè≤ËÆ∞ÂΩïÂàóË°® -->
  <view class="history-section">
    <view class="history-header">
      <text class="history-title">History Log</text>
    </view>
    
    <view class="history-list">
      <view 
        wx:for="{{stats.records}}" 
        wx:key="id"
        class="history-item {{theme === 'dark' ? 'dark' : ''}}"
        bindtap="onRecordTap"
        data-id="{{item.id}}"
      >
        <!-- Êµ∑Êä•Áº©Áï•Âõæ -->
        <view class="history-poster">
          <image 
            wx:if="{{item.posterImage}}"
            class="poster-image" 
            src="{{item.posterImage}}" 
            mode="aspectFill"
          />
          <view wx:else class="poster-placeholder">
            <text class="placeholder-text">IMG</text>
          </view>
        </view>
        
        <!-- ‰ø°ÊÅØ -->
        <view class="history-info">
          <text class="history-title">{{item.title}}</text>
          <text class="history-details">{{item.date}} ‚Ä¢ {{item.location}}</text>
        </view>
        
        <!-- ‰ª∑Ê†º -->
        <text class="history-price">¬•{{item.price}}</text>
      </view>
      
      <!-- Á©∫Áä∂ÊÄÅ -->
      <view wx:if="{{stats.records.length === 0}}" class="empty-history">
        <text class="empty-text">ÊöÇÊó†Êï∞ÊçÆ</text>
      </view>
    </view>
  </view>
</view>